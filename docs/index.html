<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Junli Liu, Purity Jangaya, Luis Alonso Alvarez &amp; Jimmy Wang">
<meta name="dcterms.date" content="2025-11-20">

<title>Predicting Wine Quality using Random Forest Classifier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="wine_quality_predictor_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="wine_quality_predictor_report_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="wine_quality_predictor_report_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="wine_quality_predictor_report_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="wine_quality_predictor_report_files/libs/quarto-html/popper.min.js"></script>
<script src="wine_quality_predictor_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="wine_quality_predictor_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="wine_quality_predictor_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="wine_quality_predictor_report_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="wine_quality_predictor_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="wine_quality_predictor_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="wine_quality_predictor_report_files/libs/bootstrap/bootstrap-1e118674f8eeaf0dc11d6faf9a2d8791.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#why-random-forest" id="toc-why-random-forest" class="nav-link" data-scroll-target="#why-random-forest">Why Random Forest?</a></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research Questions</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#analysis-pipeline" id="toc-analysis-pipeline" class="nav-link" data-scroll-target="#analysis-pipeline">Analysis Pipeline</a></li>
  </ul></li>
  <li><a href="#implementation" id="toc-implementation" class="nav-link" data-scroll-target="#implementation">Implementation</a>
  <ul class="collapse">
  <li><a href="#data-loading-and-preparation" id="toc-data-loading-and-preparation" class="nav-link" data-scroll-target="#data-loading-and-preparation">1. Data Loading and Preparation</a></li>
  <li><a href="#data-validation" id="toc-data-validation" class="nav-link" data-scroll-target="#data-validation">1.1 Data Validation</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">2. Exploratory Data Analysis</a></li>
  <li><a href="#data-preprocessing-for-random-forest" id="toc-data-preprocessing-for-random-forest" class="nav-link" data-scroll-target="#data-preprocessing-for-random-forest">3. Data Preprocessing for Random Forest</a></li>
  <li><a href="#random-forest-model-development" id="toc-random-forest-model-development" class="nav-link" data-scroll-target="#random-forest-model-development">4. Random Forest Model Development</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">5. Model Evaluation</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="../wine_quality_predictor_report.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicting Wine Quality using Random Forest Classifier</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Junli Liu, Purity Jangaya, Luis Alonso Alvarez &amp; Jimmy Wang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 20, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This project implements a Random Forest classifier to predict wine quality based on physicochemical properties. Using the Wine Quality dataset from the UCI Machine Learning Repository (6,497 samples with 11 features, reduced to 5,320 after removing duplicates), we develop a robust prediction model that leverages the ensemble learning capabilities of Random Forest. Our analysis demonstrates that Random Forest effectively handles the non-linear relationships between chemical properties and wine quality, achieving an accuracy of approximately 74.6% on the test set. The model identifies alcohol content, volatile acidity, and density as the most influential factors in determining wine quality. This work provides valuable insights for wine producers to optimize production processes and maintain consistent quality standards.</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Wine quality assessment traditionally relies on subjective evaluation by human experts. This project explores the potential of machine learning, specifically Random Forest classification, to predict wine quality from objective physicochemical measurements.</p>
<section id="why-random-forest" class="level3">
<h3 class="anchored" data-anchor-id="why-random-forest">Why Random Forest?</h3>
<p>We selected Random Forest as our primary algorithm for several reasons:</p>
<ol type="1">
<li><strong>Ensemble Learning</strong>: Combines multiple decision trees to reduce overfitting and improve generalization</li>
<li><strong>Feature Importance</strong>: Provides built-in feature importance metrics for understanding wine quality factors</li>
<li><strong>Robustness</strong>: Handles outliers and noise effectively without extensive preprocessing</li>
<li><strong>Non-linear Relationships</strong>: Captures complex interactions between chemical properties</li>
<li><strong>No Scaling Required</strong>: Works well with features at different scales</li>
<li><strong>Out-of-Bag (OOB) Error</strong>: Provides unbiased error estimates without separate validation set</li>
</ol>
</section>
<section id="research-questions" class="level3">
<h3 class="anchored" data-anchor-id="research-questions">Research Questions</h3>
<ol type="1">
<li>Can Random Forest effectively predict wine quality from physicochemical properties?</li>
<li>Which chemical properties are most important for determining wine quality?</li>
<li>What are the optimal hyperparameters for our Random Forest model?</li>
</ol>
</section>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>We used the Wine Quality Dataset from <span class="citation" data-cites="cortez2009modeling">(<a href="#ref-cortez2009modeling" role="doc-biblioref">Cortez et al. 2009</a>)</span>, comprising 6,490 wine samples (1,599 red, 4,891 white) with 11 physicochemical features and quality scores ranging from 3-9. After comprehensive data validation using Pandera, we trained a Random Forest classifier <span class="citation" data-cites="breiman2001random">(<a href="#ref-breiman2001random" role="doc-biblioref">Breiman 2001</a>)</span> using scikit-learn <span class="citation" data-cites="pedregosa2011scikit">(<a href="#ref-pedregosa2011scikit" role="doc-biblioref">Pedregosa et al. 2011</a>)</span>. The data was split 75/25 for training and testing, with 5-fold stratified cross-validation for model selection. Hyperparameters were optimized using grid search over number of trees (100-300), max depth (10-30, None), and minimum samples for splitting (2-10) and leaf nodes (1-4). Model performance was evaluated using accuracy, precision, recall, F1-score, and confusion matrices, with feature importance rankings to identify key wine quality predictors.</p>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p><strong>Dataset</strong>: Wine Quality Dataset (<span class="citation" data-cites="cortez2009modeling">Cortez et al. (<a href="#ref-cortez2009modeling" role="doc-biblioref">2009</a>)</span>) - <strong>Red wine</strong>: 1,599 samples - <strong>White wine</strong>: 4,898 samples - <strong>Subtotal</strong>: 6,497 samples - <strong>Total</strong>: 6,497 samples (5,320 after removing duplicates)</p>
<p><strong>Features (11 physicochemical properties)</strong>: 1. Fixed acidity (g/dm³) 2. Volatile acidity (g/dm³) 3. Citric acid (g/dm³) 4. Residual sugar (g/dm³) 5. Chlorides (g/dm³) 6. Free sulfur dioxide (mg/dm³) 7. Total sulfur dioxide (mg/dm³) 8. Density (g/cm³) 9. pH 10. Sulphates (g/dm³) 11. Alcohol (% vol.)</p>
<p><strong>Target</strong>: Quality score (3-9, originally 0-10 scale)</p>
<p><strong>Citation</strong>: P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. Modeling wine preferences by data mining from physicochemical properties. Decision Support Systems, 47(4):547-553, 2009.</p>
</section>
<section id="analysis-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="analysis-pipeline">Analysis Pipeline</h3>
<ol type="1">
<li><strong>Data Preparation</strong>
<ul>
<li>Load and combine red/white wine datasets</li>
<li>Handle class imbalance through stratified splitting</li>
<li>Create quality categories (Low: 3-5, Medium: 6-7, High: 8-9)</li>
</ul></li>
<li><strong>Exploratory Data Analysis</strong>
<ul>
<li>Analyze quality distribution</li>
<li>Examine feature correlations</li>
<li>Identify potential predictors</li>
</ul></li>
<li><strong>Random Forest Implementation</strong>
<ul>
<li>Build initial Random Forest with 100 trees</li>
<li>Analyze out-of-bag (OOB) error</li>
<li>Extract feature importances</li>
<li>Evaluate model performance</li>
</ul></li>
<li><strong>Hyperparameter Optimization</strong>
<ul>
<li>Grid search for optimal parameters:
<ul>
<li>n_estimators (number of trees)</li>
<li>max_depth (tree depth)</li>
<li>min_samples_split</li>
<li>min_samples_leaf</li>
<li>max_features</li>
</ul></li>
</ul></li>
<li><strong>Model Comparison</strong>
<ul>
<li>Benchmark against Logistic Regression, SVM, and Gradient Boosting</li>
<li>Validate Random Forest superiority</li>
</ul></li>
<li><strong>Final Evaluation</strong>
<ul>
<li>Test set performance</li>
<li>Confusion matrix analysis</li>
<li>Feature importance interpretation</li>
</ul></li>
</ol>
</section>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<section id="data-loading-and-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-loading-and-preparation">1. Data Loading and Preparation</h3>
<p>To begin our analysis, we downloaded the two wine quality datasets provided by Cortez et al.&nbsp;(2009). These files contain measurements for red and white wine samples, including physicochemical properties and expert-assigned quality scores.</p>
<p>The data were downloaded using our automated script, which saves the raw files into the data/raw directory.</p>
<p>The two datasets downloaded were:</p>
<ul>
<li>winequality-red.csv</li>
<li>winequality-white.csv</li>
</ul>
</section>
<section id="data-validation" class="level3">
<h3 class="anchored" data-anchor-id="data-validation">1.1 Data Validation</h3>
<p>Before proceeding with the analysis, we perform comprehensive data validation checks to ensure the quality and integrity of the dataset. Following this <a href="https://ubc-dsci.github.io/reproducible-and-trustworthy-workflows-for-data-science/lectures/130-data-validation.html#data-validation-checklist">Data Validation Checklist</a>, we use Pandera <span class="citation" data-cites="bantilan2020pandera">(<a href="#ref-bantilan2020pandera" role="doc-biblioref">Bantilan 2020</a>)</span>, a statistical schema validation library for Python, to systematically check data types, ranges, and constraints.</p>
<p>We validated the raw red and white wine datasets prior to analysis by confirming correct file structure, column names, and data types, and verifying the absence of missing or empty observations. Duplicate records (1,177 rows) were removed from the combined dataset, resulting in 5,320 unique samples. All features fell within expected ranges, category levels were valid, and the target variable showed a highly imbalanced—but expected—quality distribution. Correlation checks indicated no problematic collinearity or data leakage issues.</p>
</section>
<section id="exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis">2. Exploratory Data Analysis</h3>
<p>Our exploratory analysis reveals several key insights about the wine quality dataset:</p>
<p><strong>Quality Distribution:</strong> As shown in <a href="#fig-quality-distribution" class="quarto-xref">Figure&nbsp;1</a>, wine quality scores follow a normal distribution centered around scores 5-6, with very few wines receiving extreme ratings (3 or 9). The dataset exhibits a significant class imbalance, with medium-quality wines (scores 6-7) comprising the majority of samples. White wines show a broader distribution across quality scores compared to red wines, which are more concentrated in the 5-6 range.</p>
<p><strong>Feature-Quality Relationships:</strong> <a href="#fig-feature-correlations" class="quarto-xref">Figure&nbsp;2</a> demonstrates that alcohol content exhibits the strongest positive correlation with wine quality, suggesting that higher alcohol wines tend to receive better ratings. Conversely, volatile acidity shows the strongest negative correlation, indicating that wines with higher acetic acid levels are rated lower. Other notable positive correlates include citric acid and sulphates, while density and chlorides show negative associations with quality.</p>
<p><strong>Feature Intercorrelations:</strong> The correlation heatmap in <a href="#fig-correlation-heatmap" class="quarto-xref">Figure&nbsp;3</a> reveals important relationships between physicochemical properties. Strong positive correlations exist between free and total sulfur dioxide, and between density and residual sugar. Alcohol shows a strong negative correlation with density, which is chemically expected. These intercorrelations suggest potential multicollinearity that may need to be addressed in our modeling approach, particularly when using linear methods.</p>
<p>These patterns inform our modeling strategy: the class imbalance requires careful handling, the strong alcohol-quality relationship suggests it will be a key predictive feature, and the feature intercorrelations indicate that regularization techniques or tree-based methods may be particularly appropriate for this dataset.</p>
<div id="fig-quality-distribution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quality-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../results/figures/quality_distributions.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-quality-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Wine quality distribution analysis showing (a) overall quality score distribution, (b) distribution by wine type, and (c) quality categories for classification
</figcaption>
</figure>
</div>
<p><a href="#fig-quality-distribution" class="quarto-xref">Figure&nbsp;1</a> shows the distribution of wine quality scores. Most wines receive medium quality scores (5-7), with very few at the extremes.</p>
<div id="fig-feature-correlations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feature-correlations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../results/figures/feature_correlations.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-feature-correlations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Feature correlations with wine quality
</figcaption>
</figure>
</div>
<p><a href="#fig-feature-correlations" class="quarto-xref">Figure&nbsp;2</a> reveals that alcohol content shows the strongest positive correlation with quality, while volatile acidity shows the strongest negative correlation.</p>
<div id="fig-correlation-heatmap" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-correlation-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../results/figures/correlation_heatmap.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Feature correlation heatmap
</figcaption>
</figure>
</div>
<p><a href="#fig-correlation-heatmap" class="quarto-xref">Figure&nbsp;3</a> displays the correlations between all physicochemical features, helping identify potential multicollinearity issues for our models.</p>
</section>
<section id="data-preprocessing-for-random-forest" class="level3">
<h3 class="anchored" data-anchor-id="data-preprocessing-for-random-forest">3. Data Preprocessing for Random Forest</h3>
<p>The wine quality dataset was prepared for analysis by separating the features (physicochemical properties of the wine) from the target variable (the quality category). The quality categories were encoded numerically so that the machine learning model could process them.</p>
<p>To ensure the model learned effectively, the dataset was split into a training set (used to train the model) and a test set (used to evaluate the model’s performance on unseen data). The split was stratified, meaning the proportions of each quality category in the training and test sets match the overall dataset distribution. This helps the model fairly learn from all classes of wine quality.</p>
<div class="cell" data-execution_count="3">
<div id="tbl-summary_df" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Summary of Data Split
</figcaption>
<div aria-describedby="tbl-summary_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Dataset</th>
<th data-quarto-table-cell-role="th">Samples</th>
<th data-quarto-table-cell-role="th">Features</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Training Set</td>
<td>4256</td>
<td>12</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Test Set</td>
<td>1064</td>
<td>12</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="4">
<div id="tbl-train_dist_df" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="4">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-train_dist_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Training set class distribution table
</figcaption>
<div aria-describedby="tbl-train_dist_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Quality Category</th>
<th data-quarto-table-cell-role="th">Samples</th>
<th data-quarto-table-cell-role="th">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>High (8-9)</td>
<td>122</td>
<td>2.9</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Low (3-5)</td>
<td>1591</td>
<td>37.4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Medium (6-7)</td>
<td>2543</td>
<td>59.8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="5">
<div id="tbl-test_dist_df" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="5">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-test_dist_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Test set class distribution table
</figcaption>
<div aria-describedby="tbl-test_dist_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Quality Category</th>
<th data-quarto-table-cell-role="th">Samples</th>
<th data-quarto-table-cell-role="th">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>High (8-9)</td>
<td>31</td>
<td>2.9</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Low (3-5)</td>
<td>397</td>
<td>37.3</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Medium (6-7)</td>
<td>636</td>
<td>59.8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>This preprocessing ensured that the model would learn from all classes and could generalize well to new, unseen wines.</p>
</section>
<section id="random-forest-model-development" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-model-development">4. Random Forest Model Development</h3>
<p>A Random Forest classifier, consisting of 100 decision trees, was trained on the processed data to predict wine quality. The model’s performance was evaluated using several metrics:</p>
<ul>
<li><p>Training Accuracy: Measures how well the model fits the training data.</p></li>
<li><p>Test Accuracy: Measures how well the model generalizes to new, unseen data.</p></li>
<li><p>Out-of-Bag (OOB) Score: An internal validation method for Random Forests, giving an unbiased estimate of model performance.</p></li>
<li><p>Cross-Validation Accuracy: Performance measured by repeatedly splitting the training set into subsets to validate the model, ensuring stability of results.</p></li>
</ul>
<div class="cell" data-execution_count="7">
<div id="tbl-rf_perf_df" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rf_perf_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Random Forest performance table
</figcaption>
<div aria-describedby="tbl-rf_perf_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Metric</th>
<th data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Training Accuracy</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Test Accuracy</td>
<td>0.7462</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Out-of-Bag (OOB) Score</td>
<td>0.7333</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Cross-Validation Accuracy</td>
<td>0.7324 ± 0.0371</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>Note on class-specific metrics: Some classes, particularly the very high-quality wines, have very few samples. During evaluation, metrics such as precision and recall may be undefined for these classes because the model predicted zero samples in them. This does not affect the overall accuracy or the main performance conclusions of the model.</p>
<p>These results indicate that the model fits the training data very well while maintaining good predictive performance on unseen data. This demonstrates that the Random Forest classifier is effective in predicting wine quality based on physicochemical properties.</p>
</section>
<section id="model-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation">5. Model Evaluation</h3>
<section id="baseline-random-forest-confusion-matrix-and-classification-report" class="level4">
<h4 class="anchored" data-anchor-id="baseline-random-forest-confusion-matrix-and-classification-report">5.1. Baseline Random Forest: Confusion Matrix and Classification Report</h4>
<p>In this step, we evaluate the performance of the trained Random Forest classifier using a confusion matrix and a detailed classification report. The evaluation script loads the cleaned dataset, applies the previously trained model, and computes key metrics such as precision, recall, and F1-score for each wine-quality class.</p>
<section id="confusion-matrix" class="level5">
<h5 class="anchored" data-anchor-id="confusion-matrix">5.1.1 Confusion Matrix</h5>
<p>The confusion matrix provides a visual summary of how well the model distinguishes between the different categories, while the classification report breaks down performance per class.</p>
<p>Due to the natural class imbalance in the wine-quality dataset, some classes have very few samples, which results in undefined precision and recall values (these appear as warnings during evaluation). Despite this, the evaluation helps identify where the model performs well and where predictions remain challenging.</p>
<p>The model was evaluated using the test set generated during preprocessing.</p>
<div id="cell-fig-confusion-matrix" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">
<div id="fig-confusion-matrix" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="wine_quality_predictor_report_files/figure-html/fig-confusion-matrix-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="512" height="408">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Confusion Matrix for Random Forest Classifier
</figcaption>
</figure>
</div>
</div>
</div>
<section id="interpretation-of-confusion-matrix" class="level6">
<h6 class="anchored" data-anchor-id="interpretation-of-confusion-matrix">Interpretation of Confusion Matrix</h6>
<p>The model correctly classifies most Medium (6–7) and Low (3–5) quality wines, which form the majority of the dataset. However, it rarely predicts the High (8–9) class correctly, reflecting the very small number of training examples in this category.</p>
</section>
</section>
<section id="classification-report" class="level5">
<h5 class="anchored" data-anchor-id="classification-report">5.1.2 Classification Report</h5>
<p>The following classification report was generated by the evaluation script.</p>
<div id="classification-report" class="cell" data-tbl-cap="Classification Report from Random Forest Model" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest Classification Report

              precision    recall  f1-score   support

  High (8-9)       0.00      0.00      0.00        31
   Low (3-5)       0.72      0.65      0.68       397
Medium (6-7)       0.76      0.84      0.80       636

    accuracy                           0.75      1064
   macro avg       0.49      0.50      0.49      1064
weighted avg       0.72      0.75      0.73      1064
</code></pre>
</div>
</div>
<section id="interpretation-of-classification-report" class="level6">
<h6 class="anchored" data-anchor-id="interpretation-of-classification-report">Interpretation of Classification Report</h6>
<p>The overall accuracy of 75% suggests that the model performs reasonably well. The weighted averages are high because most samples belong to the Medium and Low classes, which the model predicts effectively. However, the macro average is much lower (≈0.49), indicating that the model performs poorly on the rare High (8–9) class.</p>
</section>
</section>
<section id="discussion" class="level5">
<h5 class="anchored" data-anchor-id="discussion">5.1.3 Discussion</h5>
<p>Overall, the Random Forest model is suitable for predicting Low and Medium wine quality but not reliable for detecting High-quality wines. Improving performance on the minority class may require techniques such as resampling, class weighting, or training a different model.</p>
</section>
</section>
<section id="feature-importance-analysis" class="level4">
<h4 class="anchored" data-anchor-id="feature-importance-analysis">5.2 Feature Importance Analysis</h4>
<p>To better understand how the Random Forest classifier makes its predictions, we analyzed the importance of each input feature. Tree-based models such as Random Forests compute importance scores based on how much each feature reduces impurity across all decision trees in the ensemble.</p>
<p>The analysis script loads the processed dataset and the trained model, extracts the feature importances, and generates both a visualization and a ranked table of feature contributions. This allows us to identify which chemical properties of the wine were most influential in determining wine-quality categories.</p>
<div id="cell-fig-feature-importance" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div id="fig-feature-importance" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feature-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="wine_quality_predictor_report_files/figure-html/fig-feature-importance-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="481" height="410">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-feature-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Feature Importance Scores from the Random Forest Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>The top features identified by the model are shown below:</p>
<div class="cell" data-execution_count="12">
<div id="tbl-feature-importance" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="12">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-feature-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Top 5 Most Important Features Identified by the Random Forest Model
</figcaption>
<div aria-describedby="tbl-feature-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">feature</th>
<th data-quarto-table-cell-role="th">importance</th>
<th data-quarto-table-cell-role="th">cumulative_importance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>alcohol</td>
<td>0.146571</td>
<td>0.146571</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>volatile acidity</td>
<td>0.104908</td>
<td>0.251479</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>density</td>
<td>0.104558</td>
<td>0.356038</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>total sulfur dioxide</td>
<td>0.087766</td>
<td>0.443804</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>free sulfur dioxide</td>
<td>0.087265</td>
<td>0.531069</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>The feature importance analysis above indicates that alcohol and volatile acidity features play a substantial role in distinguishing wine-quality categories in this dataset. The remaining features contribute smaller but still meaningful incremental value.</p>
</section>
<section id="hyperparameter-tuning-of-random-forest" class="level4">
<h4 class="anchored" data-anchor-id="hyperparameter-tuning-of-random-forest">5.3 Hyperparameter Tuning of Random Forest</h4>
<p>To improve predictive performance, the Random Forest classifier was tuned to optimize its hyperparameters for the task of predicting wine quality categories. The tuning process aimed to maximize model accuracy while ensuring balanced performance across all quality classes, particularly addressing the underrepresented “High (8-9)” category.</p>
<p>Stratified cross-validation was used to evaluate different combinations of hyperparameters, and class imbalance was handled using balanced class weights to ensure the minority class contributed proportionally to the training process. The resulting optimized model demonstrates improved generalization and robust performance on unseen test data.</p>
<section id="class-distribution" class="level5">
<h5 class="anchored" data-anchor-id="class-distribution">5.3.1 Class Distribution</h5>
<p>The distribution of wine quality categories in the training and test sets is shown in Tables <a href="#tbl-train_dist_df" class="quarto-xref">Table&nbsp;2</a> and <a href="#tbl-test_dist_df" class="quarto-xref">Table&nbsp;3</a> (created during the data preprocessing stage). These tables summarize both the number of samples and the percentage of each quality class in the respective datasets.</p>
<p>As shown, the dataset exhibits a noticeable class imbalance, particularly for the minority “High (8-9)” category. To address this, the Random Forest classifier was trained using class_weight=“balanced” to ensure the model adequately learns from underrepresented classes without being biased toward the majority categories.</p>
</section>
</section>
<section id="hyperparameter-tuning-results" class="level4">
<h4 class="anchored" data-anchor-id="hyperparameter-tuning-results">5.3.2 Hyperparameter Tuning Results</h4>
<p>The GridSearchCV process explored 324 combinations of hyperparameters over 5-fold stratified cross-validation. The best hyperparameters identified are shown in Table <a href="#tbl-best_params_df" class="quarto-xref">Table&nbsp;6</a>.</p>
<div class="cell" data-execution_count="15">
<div id="tbl-best_params_df" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="15">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-best_params_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Best Random Forest Hyperparameters
</figcaption>
<div aria-describedby="tbl-best_params_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Hyperparameter</th>
<th data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>max_depth</td>
<td>30</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>max_features</td>
<td>sqrt</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>min_samples_leaf</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>min_samples_split</td>
<td>5</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>n_estimators</td>
<td>200</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<div id="cell-cv-score" class="cell" data-execution_count="16">
<div id="cv-score" class="cell-output cell-output-display" data-execution_count="34">
<pre><code>0.7375</code></pre>
</div>
</div>
<p>The best cross-validation accuracy achieved was 0.7375, indicating consistent performance across the training folds.</p>
<p>These hyperparameters balance tree complexity and generalization. For example, max_depth of 30 allows sufficiently deep trees, while 2 prevents overfitting small branches. Limiting the number of features considered at each split using sqrt helps improve model robustness.</p>
</section>
<section id="test-set-performance" class="level4">
<h4 class="anchored" data-anchor-id="test-set-performance">5.3.3 Test Set Performance</h4>
<p>The performance of the optimized Random Forest model was evaluated on the held-out test set. The key metrics are summarized in Table <a href="#tbl-test_metrics_df" class="quarto-xref">Table&nbsp;7</a>.</p>
<div class="cell" data-execution_count="17">
<div id="tbl-test_metrics_df" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="17">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-test_metrics_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Optimized Random Forest Test Set Performance
</figcaption>
<div aria-describedby="tbl-test_metrics_df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Metric</th>
<th data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Accuracy</td>
<td>0.753</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Precision</td>
<td>0.758</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Recall</td>
<td>0.753</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>F1-Score</td>
<td>0.741</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>The accuracy of 0.753 indicates that the model generalizes well to unseen data. The balanced precision (0.758) and recall (0.753) suggest that the model does not disproportionately favor any class despite the underlying class imbalance. The slightly lower F1-score (0.741) reflects some trade-offs in correctly classifying the minority “High (8-9)” wines, which is expected given their rarity.</p>
</section>
<section id="confusion-matrix-1" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-1">5.3.4 Confusion Matrix</h4>
<p>The confusion matrix <a href="#fig-conf-matrix" class="quarto-xref">Figure&nbsp;6</a> summarizes the model’s predictions on the test set across all wine quality categories. It provides detailed insight into per-class performance, highlighting where the model succeeds and where misclassifications occur.</p>
<p>The confusion matrix (Figure 1) illustrates how the model performs across the three wine quality categories. The use of balanced class weights helped the classifier better identify the minority “High (8-9)” wines while maintaining accuracy on the more common categories.</p>
<div id="fig-conf-matrix" class="quarto-float quarto-figure quarto-figure-center anchored" width="60%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-conf-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../results/evaluation/confusion_matrix_random_forest_optimized.png" id="fig-conf-matrix" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-conf-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6
</figcaption>
</figure>
</div>
<p>Key observations from the confusion matrix include:</p>
<ul>
<li><p>The model correctly classifies the majority of “Medium (6-7)” and “Low (3-5)” wines, which are the dominant classes in the dataset.</p></li>
<li><p>Importantly, the previously underrepresented “High (8-9)” wines, which had virtually no correct predictions before hyperparameter tuning of the Random Forest model, are now having some values classified more accurately. This improvement is largely due to the use of balanced class weights during training and hyperparameter tuning.</p></li>
<li><p>Some misclassifications still occur for the “High (8-9)” category, reflecting its rarity and the inherent difficulty in predicting minority classes. However, the optimized Random Forest achieves a meaningful trade-off between overall accuracy and minority class recall.</p></li>
</ul>
<p>Key Takeaways:</p>
<ul>
<li><p>Hyperparameter tuning with GridSearchCV, combined with class balancing, has improved model generalization and robustness.</p></li>
<li><p>The optimized Random Forest can now handle imbalanced class distributions effectively, providing both high accuracy and better sensitivity for the minority class.</p></li>
</ul>
</section>
<section id="key-findings" class="level4">
<h4 class="anchored" data-anchor-id="key-findings">Key Findings</h4>
<ul>
<li><strong>Alcohol content</strong> emerged as the most important predictor (importance: 0.1466), consistent with wine industry knowledge.</li>
<li><strong>Volatile acidity</strong> and <strong>density</strong> were also important predictors.</li>
<li>The optimized Random Forest model achieved a balanced performance across classes with test accuracy of 0.7375 and well-balanced precision and recall.</li>
</ul>
</section>
<section id="practical-applications" class="level4">
<h4 class="anchored" data-anchor-id="practical-applications">Practical Applications</h4>
<ol type="1">
<li><strong>Quality Control</strong>: Winemakers can use the model to predict quality during production</li>
<li><strong>Process Optimization</strong>: Focus on controlling key chemical properties identified by feature importance</li>
<li><strong>Objective Assessment</strong>: Complement subjective expert ratings with data-driven predictions</li>
</ol>
</section>
<section id="limitations-and-future-work" class="level4">
<h4 class="anchored" data-anchor-id="limitations-and-future-work">Limitations and Future Work</h4>
<ol type="1">
<li><strong>Dataset Scope</strong>: Limited to Portuguese “Vinho Verde” wines.</li>
<li><strong>Feature Set</strong>: Additional sensory or temporal data could further improve predictions.</li>
<li><strong>Class Imbalance</strong>: High-quality wines (8-9) represent only ~3% of samples; model tuning with balanced class weights helped reduce bias toward majority classes.</li>
<li><strong>Future Directions</strong>:
<ul>
<li>Extend the model to other wine regions and varieties.</li>
<li>Incorporate temporal data and wine aging effects.</li>
<li>Explore additional techniques for handling class imbalance (e.g., SMOTE).</li>
<li>Develop real-time quality monitoring systems.</li>
</ul></li>
</ol>
</section>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>This project demonstrated that the Random Forest classifier is effective for predicting wine quality from physicochemical properties. The optimized model achieved a test accuracy of 0.7375 with well-balanced precision and recall, showing good generalization to unseen data. Feature importance analysis highlighted alcohol content, volatile acidity, and density as key predictors, providing actionable insights for wine production optimization. Random Forest’s advantages—handling non-linear relationships, managing class imbalance, and providing interpretable features—make it a suitable choice for wine quality prediction in practice.</p>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bantilan2020pandera" class="csl-entry" role="listitem">
Bantilan, Niels. 2020. <span>“Pandera: Statistical Data Validation of Pandas Dataframes.”</span> In <em>SciPy</em>, 116–24.
</div>
<div id="ref-breiman2001random" class="csl-entry" role="listitem">
Breiman, Leo. 2001. <span>“Random Forests.”</span> <em>Machine Learning</em> 45 (1): 5–32. <a href="https://doi.org/10.1023/A:1010933404324">https://doi.org/10.1023/A:1010933404324</a>.
</div>
<div id="ref-cortez2009modeling" class="csl-entry" role="listitem">
Cortez, Paulo, A Cerdeira, F Almeida, T Matos, and J Reis. 2009. <span>“Modeling Wine Preferences by Data Mining from Physicochemical Properties.”</span> <em>Decision Support Systems</em> 47 (4): 547–53. <a href="https://doi.org/10.1016/j.dss.2009.05.016">https://doi.org/10.1016/j.dss.2009.05.016</a>.
</div>
<div id="ref-pedregosa2011scikit" class="csl-entry" role="listitem">
Pedregosa, Fabian, Gaël Varoquaux, Alexandre Gramfort, Vincent Michel, Bertrand Thirion, Olivier Grisel, Mathieu Blondel, et al. 2011. <span>“Scikit-Learn: Machine Learning in Python.”</span> <em>Journal of Machine Learning Research</em> 12: 2825–30.
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>